<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Multiple readers and writers</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../assets/stylesheets/application.css"><link rel="stylesheet" href="../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation"><header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><a href="http://www.couchbase.com/learn" class="developer-porta-header__navigation__back">
							Return to Learn
						</a><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/developer">Developer Documentation</a></li><li class="developer-portal-header__navigation__item"><a href="http://developer.couchbase.com/mobile">Couchbase Mobile</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li><li class="developer-portal-header__navigation__item"><a href="http://docs.couchbase.com/archive-index">Documentation Archives</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><div class="developer-portal-sidebar__versions"><ul id="developer-portal-versions-navigation"><li class="active"><a href="#"><span>Version 3.0</span></a></li><li class=""><a href="http://docs.couchbase.com/archive-index"><span>Older</span></a></li></ul></div><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../Couchbase-intro.html"><span>はじめに</span></a></li><li class="section"><a href="../Whats-new-3.0.html"><span>3.0の新機能</span></a></li><li class="section section--has-sub-sections"><a href="../install-intro.html"><span>インストールとアップグレード</span></a></li><li class="section section--has-sub-sections section--active"><a href="../admin-intro.html"><span>Couchbase Serverの管理</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../Misc/admin-basics.html"><span>管理の基礎</span></a></li><li class="section section--has-sub-sections section--active"><a href="../Concepts/concept-intro.html"><span>アーキテクチャと概念</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../Concepts/concept-clusterMgr.html"><span>クラスタマネージャ</span></a></li><li class="section"><a href="../Concepts/concept-dataStorage.html"><span>データストレージ</span></a></li><li class="section"><a href="../Concepts/concept-ramQuota.html"><span>RAM割当量</span></a></li><li class="section"><a href="../Concepts/concept-vBucket.html"><span>vBuckets</span></a></li><li class="section"><a href="../Concepts/concept-cacheLayer.html"><span>キャッシュレイヤー</span></a></li><li class="section section--has-sub-sections section--active"><a href="../Concepts/concept-diskStorage.html"><span>ディスクストレージ</span></a><ul class="sub-sections"><li class="section"><a href="../Concepts/concept-readerWriter.html" class="current"><span>Multiple readers and writers</span></a><ul class="sub-sections"></ul></li><li class="section"><a href="../Concepts/concept-doc-delete.html"><span>ドキュメントの削除</span></a></li><li class="section"><a href="../Concepts/concept-tombstone.html"><span>Tombstone purging</span></a></li></ul></li><li class="section"><a href="../Concepts/global-thread-pool.html"><span>共有スレッドプール</span></a></li><li class="section"><a href="../Concepts/bucket-priority.html"><span>ディスクI/O優先度</span></a></li><li class="section section--has-sub-sections"><a href="../Concepts/bucket-eviction.html"><span>チューナブルメモリ</span></a></li><li class="section"><a href="../Concepts/concept-docExpiration.html"><span>アイテムの有効期限</span></a></li><li class="section"><a href="../Concepts/concept-serverWarmup.html"><span>Server warmup</span></a></li><li class="section"><a href="../Concepts/concept-replication.html"><span>レプリカとレプリケーション</span></a></li><li class="section"><a href="../Concepts/concepts-TAP.html"><span>TAP</span></a></li><li class="section"><a href="../Concepts/dcp.html"><span>データベース変更プロトコル(DCP)</span></a></li><li class="section"><a href="../Concepts/concept-client-interface.html"><span>クライアントインタフェース</span></a></li><li class="section"><a href="../Concepts/concepts-statsMonitor.html"><span>統計情報とモニタリング</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../security/security-intro.html"><span>セキュリティ</span></a></li><li class="section section--has-sub-sections"><a href="../Concepts/bp-deployment-considerations.html"><span>デプロイ構成の考慮事項</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/cluster-management.html"><span>クラスタ管理</span></a></li><li class="section section--has-sub-sections"><a href="../Monitoring/monitor-intro.html"><span>モニタリング</span></a></li><li class="section section--has-sub-sections"><a href="../XDCR/xdcr-intro.html"><span>クロスデータセンターレプリケーション（XDCR）</span></a></li><li class="section section--has-sub-sections"><a href="../UI/ui-intro.html"><span>Webコンソール</span></a></li><li class="section"><a href="../Misc/faq.html"><span>FAQ</span></a></li><li class="section section--has-sub-sections"><a href="../Misc/Trbl-intro.html"><span>トラブルシューティング</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../cli-intro.html"><span>CLIリファレンス</span></a></li><li class="section section--has-sub-sections"><a href="../rest-intro.html"><span>REST APIリファレンス</span></a></li><li class="section section--has-sub-sections"><a href="../rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
  <h1 class="title topictitle1">Multiple readers and writers</h1>

  
  
  <div class="body"><p class="shortdesc">Multi-threaded readers and writers provide multiple processes to simultaneously read
    and write data on disk. Simultaneous reads and writes increase disk speed and improve the read
    rate from disk. </p>

    
    <p class="p">Multiple readers and writers are supported to persist data on disk. For earlier versions of
      Couchbase Server, each server instance had only single disk reader and writer threads.</p>
 
      <p class="p">Disk
      speeds have now increased to the point where single read/write threads do not efficiently
      keep up with the speed of the disk hardware. The other problem caused by single read/write
      threads is that if you have a good portion of data on disk and not in RAM, you can experience a
      high level of cache misses when you request this data. </p>

     
     
     
    <div class="note note"><span class="notetitle">Note:</span> In a Couchbase Server cluster, earlier versions of Couchbase Server can 
      co-exist with higher versions of Couchbase Server. Pre-2.1 nodes remain with single readers and writer for the data bucket. 
      Post-2.1 nodes have multiple readers and writers. </div>
 
      
      <p class="p">
      When server nodes are upgraded, the multiple readers and writers setting is implemented with 
      bucket restart and warmup. In this case, install the new node, add it to the cluster, 
      and edit the existing bucket setting for readers and writers.</p>
 
      <p class="p">After rebalancing the cluster, 
      the new node performs reads and writes with multiple readers and writers and the data bucket 
      does not restart or go through a warmup. All existing pre–2.1 nodes remain with a single readers 
      and writers for the data bucket. As pre-2.1 nodes are upgraded and added to the cluster, 
      these new nodes automatically pick up the setting and use multiple readers and writers for the bucket.</p>



    
    <p class="p">The multi-threaded engine includes additional synchronization among threads that are accessing the 
      same data cache to avoid conflicts. To maintain performance while avoiding conflicts over data, 
      Couchbase Server uses a form of locking between threads and thread allocation among vBuckets with static partitioning.</p>
 
     <p class="p"> When Couchbase Server creates multiple reader and writer threads, the server assesses a range of vBuckets for 
      each thread and assigns each thread exclusively to certain vBuckets. 
      With this static thread coordination, the server schedules threads so that only a single reader and 
      single writer thread can access the same vBucket at any given time. 
      The image shows six pre-allocated threads and two data Buckets. 
      Each thread has the range of vBuckets that is statically partitioned for read and write access.</p>

    
    <img class="image" src="../images/threads_read_write.png" width="500">
    

  </div>


<nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../Concepts/concept-diskStorage.html" title="Couchbase Serverでは、クライアントからの情報の保存や取得に対しRAMを主に利用します。 同時に、Couchbase Serverは、より高い信頼性を持たせるため、全てのデータをディスク上に保存し永続化します。">ディスクストレージ</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../Concepts/concept-doc-delete.html" title="Couchbase Serverは、クライアントが明示的にアイテムの削除を実行した場合、 もしくはアイテムのexpiration valueが期限に達した場合、以外ではディスクからアイテムが削除されることはありません。">ドキュメントの削除</a></div>
</div>
</nav></div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b> All rights reserved.</span><a href="http://www.couchbase.com/developers">Developer Portal</a><a href="http://forums.couchbase.com">Forums</a><a href="http://www.couchbase.com/downloads">Download</a><a href="http://support.couchbase.com/">Customer Support Login</a></p></footer></div></main><script src="../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../';</script><script src="../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>