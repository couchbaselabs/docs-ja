<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>リバランス実行時の考慮事項</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../assets/stylesheets/application.css"><link rel="stylesheet" href="../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation"><header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><a href="http://www.couchbase.com/learn" class="developer-porta-header__navigation__back">
							Return to Learn
						</a><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/developer">Developer Documentation</a></li><li class="developer-portal-header__navigation__item"><a href="http://developer.couchbase.com/mobile">Couchbase Mobile</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li><li class="developer-portal-header__navigation__item"><a href="http://docs.couchbase.com/archive-index">Documentation Archives</a></li></ul><div class="developer-portal-header__search"></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><div class="developer-portal-sidebar__versions"><ul id="developer-portal-versions-navigation"><li class="active"><a href="#"><span>Version 3.0</span></a></li><li class=""><a href="http://docs.couchbase.com/archive-index"><span>Older</span></a></li></ul></div><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../Couchbase-intro.html"><span>はじめに</span></a></li><li class="section"><a href="../Whats-new-3.0.html"><span>3.0の新機能</span></a></li><li class="section section--has-sub-sections"><a href="../install-intro.html"><span>インストールとアップグレード</span></a></li><li class="section section--has-sub-sections section--active"><a href="../admin-intro.html"><span>Couchbase Serverの管理</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../Misc/admin-basics.html"><span>Couchbase Server管理の基本</span></a></li><li class="section section--has-sub-sections"><a href="../Concepts/concept-intro.html"><span>アーキテクチャと概念</span></a></li><li class="section section--has-sub-sections"><a href="../security/security-intro.html"><span>セキュリティ</span></a></li><li class="section section--has-sub-sections"><a href="../Concepts/bp-deployment-considerations.html"><span>デプロイ構成の考慮事項</span></a></li><li class="section section--has-sub-sections section--active"><a href="../Tasks/cluster-management.html"><span>クラスタ管理</span></a><ul class="sub-sections"><li class="section"><a href="../Tasks/tasks-manage-serverWarmup.html"><span>サーバウォームアップの対処</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-manage-replication.html"><span>レプリケーションの設定</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-compaction.html"><span>データファイルのコンパクション</span></a></li><li class="section section--has-sub-sections section--active"><a href="../Tasks/cluster-maintenance.html"><span>クラスタのメンテナンス</span></a><ul class="sub-sections"><li class="section"><a href="../Tasks/rebalance-adding-nodes.html"><span>ノードの追加</span></a></li><li class="section"><a href="../Tasks/rebalance-remove-node.html"><span>ノードの削除</span></a></li><li class="section section--has-sub-sections section--active"><a href="../Tasks/tasks-rebalance.html"><span>リバランス</span></a><ul class="sub-sections"><li class="section"><a href="../Concepts/concept-rebalancing.html"><span>リバランス操作</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/rebalance-performing.html"><span>リバランスの実行</span></a></li><li class="section"><a href="../Tasks/rebalance-behind-the-scenes.html"><span>リバランスの舞台裏</span></a></li><li class="section"><a href="../Tasks/rebalance-bucket-types.html"><span>バケット種別によるリバランスの影響</span></a></li><li class="section"><a href="../Tasks/rebalance-swap-rebalance.html"><span>スワップリバランス</span></a></li><li class="section"><a href="../Tasks/rebalance-factors.html" class="current"><span>リバランス実行時の考慮事項</span></a><ul class="sub-sections"></ul></li><li class="section"><a href="../Tasks/rebalance-questions.html"><span>一般的なリバランスに関する質問</span></a></li></ul></li></ul></li><li class="section section--has-sub-sections"><a href="../Tasks/maintenance-server-node.html"><span>Server maintenance</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-backup-restore.html"><span>Backup and restore</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-manage-xdcr.html"><span>Managing XDCR</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../Monitoring/monitor-intro.html"><span>モニタリング</span></a></li><li class="section section--has-sub-sections"><a href="../XDCR/xdcr-intro.html"><span>クロスデータセンターレプリケーション（XDCR）</span></a></li><li class="section section--has-sub-sections"><a href="../UI/ui-intro.html"><span>Webコンソール</span></a></li><li class="section"><a href="../Misc/faq.html"><span>FAQ</span></a></li><li class="section section--has-sub-sections"><a href="../Misc/Trbl-intro.html"><span>トラブルシューティング</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../Views/views-intro.html"><span>Viewとインデックス</span></a></li><li class="section section--has-sub-sections"><a href="../cli-intro.html"><span>CLIリファレンス</span></a></li><li class="section section--has-sub-sections"><a href="../rest-intro.html"><span>REST APIリファレンス</span></a></li><li class="section section--has-sub-sections"><a href="../rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
  <h1 class="title topictitle1">リバランス実行時の考慮事項</h1>

  
  <div class="body"><p class="shortdesc">クラスタをいつ、なぜ、どのようにリバランスするかは、シナリオに依存します。</p>

    <p class="p">どの状況かを選択し適用するかはいつも単純とは限らず、様々な要素がいつノード構成を変更してリバランスを行うべきかを決定します。</p>

    
    <div class="section"><h2 class="title sectiontitle">いつクラスタを拡張するべきか</h2>
    <p class="p">より多くのノードを追加することで、クラスタのサイズを拡張できます。 ノードを追加することで、利用可能なRAM、ディスクI/O、クライアントアプリケーションで利用可能なネットワーク帯域が増加し、より多くのマシンに負荷を分散可能になります。 ここでは、タイミングを決定するためにいくつかのメトリックと統計情報があります:</p>

      
      <dl class="dl">
        
          <dt class="dt dlterm">RAM容量を増加する</dt>

          <dd class="dd">Couchbase Serverクラスタ内で最も重要なコンポーネントの一つが利用可能なRAM容量です。 RAMはCouchbase Serverのキャッシュレイヤとしてアプリケーションデータを保存するだけでなく、その他のオペレーションでもサーバによって利用されます。 全体で利用可能なRAM容量を低減すると、どこか別の場所で性能の問題を引き起こすこともあります。 以下にクラスタのRAM容量を増加すべき一般的なインジケータを示します: <ul class="ul">
              <li class="li">より多くのディスクフェッチが発生している場合、アプリケーションがリクエストしたデータがRAM上に存在せず、より多くのデータをディスクからフェッチしていることを意味します。 クラスタ内のRAMを増加すると、より多くのデータをRAMに保持でき、より良いパフォーマンスをアプリケーションに提供できます。</li>

              <li class="li">Couchbase Serverクラスタにより多くのバケットを追加する場合、より多くのRAMが必要になることがあります。 ノードを追加すると、システム全体のキャパシティを増加し、既存バケットを縮小して新規バケット用の空きを作ることができます。</li>

            </ul>
</dd>

        
      </dl>

    
    
    <dl class="dl">
      
        <dt class="dt dlterm">ディスクI/Oスループットを増加させる</dt>

        <dd class="dd">Couchbase Serverクラスタにノードを追加することで、クラスタ全体で実行可能なディスクI/Oを増加させることができます。 これは特に書き込み頻度の高い環境で重要です、しかしディスクから大量のデータを参照する必要がある場合にも重要な要素となります。</dd>

      
    </dl>

    <dl class="dl">
      
        <dt class="dt dlterm">ディスク容量を増加させる</dt>

        <dd class="dd">現在のノードにより多くのディスク容量を追加するか、より多くのノードを追加することでクラスタ全体のディスク容量を追加できます。</dd>

      
    </dl>

      
      <dl class="dl">
        
          <dt class="dt dlterm">ネットワーク帯域を増加させる</dt>

          <dd class="dd">クラスタのネットワーク帯域が飽和してしまうか、飽和しそうなポイントに達した場合、より多くのノードが必要である協力なインジケータとなります。 より多くのノードはこれらの追加したノードに、必要なネットワーク帯域を拡散し、各ノード個別の帯域を削減します。</dd>

        
      </dl>

    
    </div>

      
      
      
      <div class="section"><h2 class="title sectiontitle">いつクラスタを縮小すべきか</h2>Couchbaseクラスタ縮小の選択はより主観的な判断となります。 通常は、コスト面での考慮、またはアプリケーション要件が変わり、必要な負荷に対応するために大きなクラスタが必要になくなったときに検討します。 <p class="p">いつクラスタを縮小すべきか:</p>
<ul class="ul">
        <li class="li">データセットとアプリケーション負荷をサポートするために、残りのノードで十分なキャパシティを提供できるか確認してください。 ノードを削除すると、十分なノードが存在しない場合、クラスタに不利益な重大な影響を与えることがあります。</li>

        <li class="li">理想的なクラスタサイズの決定を試行する場合、一度に複数のノードを削除することは避けてください。 代わりに、各ノードを一度に一つずつ削除し、クラスタ全体での影響を理解できるようにします。</li>

        <li class="li">フェイルオーバを利用するより、ノードの削除とリバランスを利用してください。 ノードがダウンし、クラスタに復帰しない場合、フェイルオーバ機能によってそのレプリカvBucketが即座にアクティブに昇格されます。 健全なノードをフェイルオーバすると、実行中のオペレーションのレプリケーションデータの一部を失う可能性があります。 <samp class="ph codeph">remove</samp>を利用すると、すべてのデータが正しくレプリケートされ、継続して利用可能であることを保証できます。 </li>

      </ul>
</div>

    
    <div class="section"><h2 class="title sectiontitle">いつクラスタをリバランスすべきか</h2>

    <p class="p">ノードを追加または削除することを決定したなら、次の点を考慮してください:</p>

      <ul class="ul">
                <li class="li">複数のノードを短時間で追加または削除することを計画している場合、一台ずつリバランスを実行するよりも、それらすべてを一度に追加し、リバランスを実行するのが最良の手順です。 これはシステムにかかる全体的な負荷と、移動が必要なデータ量を削減します。</li>

                <li class="li">クラスタへの負荷が低い時間帯にノードを追加します。 リバランス操作はオンラインで実行できるように設計されているものの、"全く負荷がない"処理ではなく、ディスクI/O、ネットワーク帯域、CPU利用率、RAM利用量という形でシステム全体の負荷を増加させることは疑う余地はありません。</li>

                <li class="li">自主的にリバランスを行う場合(フェイルオーバ後の復旧ではない場合)は、システムの利用が少ない時間帯に実行すべきです。 クラスタ内でデータが再分散されるため、リバランスは比較的リソースインテンシブな処理であり、全体的なクラスタパフォーマンスに不利益な影響を与えることを避けるために、システムを活発に利用している時間帯にリバランスを実行することは避けるべきです。</li>

                <li class="li">リバランスはクラスタ内で大量のデータを移動します。 より多くのRAMが利用できれば、オペレーティングシステムがより多くのディスクアクセスをキャッシュでき、リバランス処理をより高速に実行できます。 クラスタ内に十分なメモリがない場合、リバランスは非常に遅くなるでしょう。 クラスタのキャパシティを使い切る前に、新規ノードを追加しリバランスを実行することを推奨します。</li>

              </ul>

    </div>

    
  </div>

<nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>親トピック:</strong> <a class="link" href="../Tasks/tasks-rebalance.html" title="リバランスは情報をノード間に再分配する処理です。">リバランス</a></div>
<div class="previouslink"><strong>前のトピック:</strong> <a class="link" href="../Tasks/rebalance-swap-rebalance.html" title="スワップリバランスは、同数のノードを同一のオペレーションで追加、かつ削除する際に、データの移動を最適化する自動的なプロセスです。">スワップリバランス</a></div>
<div class="nextlink"><strong>次のトピック:</strong> <a class="link" href="../Tasks/rebalance-questions.html" title="一般的にリバランスに関して行われる質疑応答を紹介します。">一般的なリバランスに関する質問</a></div>
</div>
</nav></div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b> All rights reserved.</span><a href="http://www.couchbase.com/developers">Developer Portal</a><a href="http://forums.couchbase.com">Forums</a><a href="http://www.couchbase.com/downloads">Download</a><a href="http://support.couchbase.com/">Customer Support Login</a></p></footer></div></main><script src="../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../';</script><script src="../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>