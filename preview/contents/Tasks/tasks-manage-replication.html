<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>レプリケーションの設定</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../assets/stylesheets/application.css"><link rel="stylesheet" href="../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation"><header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><a href="http://www.couchbase.com/learn" class="developer-porta-header__navigation__back">
							Return to Learn
						</a><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/developer">Developer Documentation</a></li><li class="developer-portal-header__navigation__item"><a href="http://developer.couchbase.com/mobile">Couchbase Mobile</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li><li class="developer-portal-header__navigation__item"><a href="http://docs.couchbase.com/archive-index">Documentation Archives</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><div class="developer-portal-sidebar__versions"><ul id="developer-portal-versions-navigation"><li class="active"><a href="#"><span>Version 3.0</span></a></li><li class=""><a href="http://docs.couchbase.com/archive-index"><span>Older</span></a></li></ul></div><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../Couchbase-intro.html"><span>はじめに</span></a></li><li class="section"><a href="../Whats-new-3.0.html"><span>3.0の新機能</span></a></li><li class="section section--has-sub-sections"><a href="../install-intro.html"><span>インストールとアップグレード</span></a></li><li class="section section--has-sub-sections section--active"><a href="../admin-intro.html"><span>Couchbase Serverの管理</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../Misc/admin-basics.html"><span>管理の基礎</span></a></li><li class="section section--has-sub-sections"><a href="../Concepts/concept-intro.html"><span>アーキテクチャと概念</span></a></li><li class="section section--has-sub-sections"><a href="../security/security-intro.html"><span>セキュリティ</span></a></li><li class="section section--has-sub-sections"><a href="../Concepts/bp-deployment-considerations.html"><span>デプロイ構成の考慮事項</span></a></li><li class="section section--has-sub-sections section--active"><a href="../Tasks/cluster-management.html"><span>クラスタ管理</span></a><ul class="sub-sections"><li class="section"><a href="../Tasks/tasks-manage-serverWarmup.html"><span>サーバウォームアップの対処</span></a></li><li class="section section--has-sub-sections section--active"><a href="../Tasks/tasks-manage-replication.html" class="current"><span>レプリケーションの設定</span></a><ul class="sub-sections"><li class="section"><a href="../Tasks/replication-backoff.html"><span>Specifying backoff for replication</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-compaction.html"><span>Compacting data files</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/cluster-maintenance.html"><span>Cluster maintenance</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/maintenance-server-node.html"><span>Server maintenance</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-backup-restore.html"><span>Backup and restore</span></a></li><li class="section section--has-sub-sections"><a href="../Tasks/tasks-manage-xdcr.html"><span>Managing XDCR</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../Monitoring/monitor-intro.html"><span>モニタリング</span></a></li><li class="section section--has-sub-sections"><a href="../XDCR/xdcr-intro.html"><span>クロスデータセンターレプリケーション（XDCR）</span></a></li><li class="section section--has-sub-sections"><a href="../UI/ui-intro.html"><span>Webコンソール</span></a></li><li class="section"><a href="../Misc/faq.html"><span>FAQ</span></a></li><li class="section section--has-sub-sections"><a href="../Misc/Trbl-intro.html"><span>トラブルシューティング</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../cli-intro.html"><span>CLIリファレンス</span></a></li><li class="section section--has-sub-sections"><a href="../rest-intro.html"><span>REST APIリファレンス</span></a></li><li class="section section--has-sub-sections"><a href="../rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
	<h1 class="title topictitle1">レプリケーションの設定</h1>

	
	<div class="body"><p class="shortdesc">レプリカデータはCouchbaseクラスタ内で分散され、単一障害点を回避します。
	データのレプリケーションはバケットごとに、ノード単位で構成されます。</p>

		<p class="p">Couchbaseクラスタ内には、<dfn class="term">アクティブデータ</dfn>と<dfn class="term">レプリカデータ</dfn>
			が各ノード上にあります。アクティブデータはクライアントからそのノードに書き込まれたデータです。
			レプリカデータは他のノードにあるアイテムのコピーです。
		</p>

		<p class="p">Couchbase Serverにアイテムを書き込むと、そのデータのコピーをそのノードのRAMから他のノードへとコピーします。
		レプリカデータの分散はアクティブデータの分散と同様に処理されます。レプリカデータの一部分がクラスタ内で分散され、単一障害点を回避します。</p>


	<p class="p">ノード間のデータレプリケーションは完全にピアツーピアで、直接クラスタ内のノード間で情報がレプリケートされます。
		クラスタ内のノード間にトポロジ、階層、マスタ - スレーブの関係はありません。
	クライアントがクラスタ内のノードに書き込みを行うと、Couchbase Serverはそのノード上にデータを保存し、データをクラスタ内の一つ以上の他のノードに分配します。</p>

		<p class="p">以下の図はCouchbaseクラスタ内の2つのノードがどのようにお互いのレプリカデータを保存しているのかを示しています:</p>


		<img class="image" src="../images/replica_backoff.png" width="720">


		<p class="p">クライアントアプリケーションがデータをノードに書き込むと、そのデータはレプリケーションキューに追加され、コピーが他のノードに送信されます。
		レプリケートされたデータは二つ目のノードのRAM上に保存され、二つ目のノード上のディスクに書き込むために、ディスク書き込みキューに配置されます。</p>

	<p class="p">二つ目のノードはまた、レプリカデータとクライアントからの書き込みを同時に処理しています。
		レプリカデータと送信された書き込みデータを同一のディスクキューに追加します。
		ディスク書き込みキュー内のアイテム数が多くなり過ぎると、二つ目のノードは
		<dfn class="term">backoff message</dfn>
		を一つ目のノードに返すことがあります。
		すると一つ目のノードは、二つ目のノードにレプリケーションするアイテムの送信頻度を低くします。
		これは二つ目のノードがすでに大量の書き込み要求をクライアントアプリケーションから受け付けている場合に必要となります。
	 </p>

	 <p class="p">レプリケーション対象の同一のドキュメントに複数の変更が発生した場合、Couchbase Serverはアイテムを
		 <dfn class="term">deduplicate</dfn>します。
		 これは効率化のため、ドキュメントの最新のバージョンのみを二つ目のノードに送るということです。
	</p>

	<p class="p">もしシステム内の一つ目のノードがダウンしても、レプリケートされたデータは二つ目のノードで利用できます。
		二つ目のノードのRAM内にデータのコピーが存在するため、Couchbaseは二つ目のノードにあるレプリカデータを即座に提供することができます。
		ダウンしたノードからデータをコピーしたり、ディスクからデータを読み込む必要はありません。
		レプリカデータが二つ目のノードで有効になると、Couchbase Serverはデータとサーバのマッピング情報を更新し、
		クライアントアプリケーションにこの情報を共有します。
		そしてクライアントアプリケーションは動作しているノードからレプリカデータを取得できるようになります。
	</p>

		
		<div class="section"><h2 class="title sectiontitle">データレプリケーションの適用</h2>
			<p class="p">必要なデータのコピー数に応じて、各バケットで異なるデータレプリケーションを設定することができます。
				データを冗長化させ可用性を高めるために、各データバケットでは最大3つのレプリカをクラスタ内に作成することができます。
			</p>

			<p class="p">レプリケーションはクラスタ内のノード数が設定したレプリカ数を満たす場合に有効となります。
				例えば、バケットのレプリカ数を3に設定した場合、クラスタ内に4つ以上のノードが存在する場合のみレプリケーションが有効となります。
				</p>

		
				<p class="p">バケットに対してレプリカ数を設定し、バケットを作成した後、レプリカ数を変更することはできません。
			このため、必要なレプリカ数を確実に指定するように注意してください。</p>
</div>

	
	</div>

	<nav class="related-links"><h2>Related information</h2>
<ol class="olchildlinks">
<li class="link olchildlink"><a href="../Tasks/replication-backoff.html">Specifying backoff for replication</a><br>
Data replication enables high availability of data in a cluster so that data is still available at a replica in case any node in a cluster fails. </li>
</ol>

<div class="familylinks">
<div class="parentlink"><strong>親トピック:</strong> <a class="link" href="../Tasks/cluster-management.html" title="運用で重要となるCouchbase Serverクラスタ管理について説明します。">クラスタ管理</a></div>
<div class="previouslink"><strong>前のトピック:</strong> <a class="link" href="../Tasks/tasks-manage-serverWarmup.html" title="Couchbase Serverのウォームアップ動作は、cbepctlツールからアクセススキャナとウォームアップ閾値を設定することで変更できます。">サーバウォームアップの対処</a></div>
<div class="nextlink"><strong>次のトピック:</strong> <a class="link" href="../Tasks/tasks-compaction.html" title="Database and view compaction helps to reclaim disk space and reduce fragmentation.">Compacting data files</a></div>
</div>

<div class="linklist linklist">
<div><a class="link" href="tasks-nodeFailover.html" title="Failing over a node means that Couchbase Server removes the node from a cluster and makes replicated data at other nodes available for client requests.">Failover considerations</a></div>
<div><a class="link" href="tasks-rebalance.html" title="Rebalancing is the process of redistributing information across nodes.">Rebalancing</a></div>
<div><a class="link" href="../UI/ui-data-buckets.html">Data Buckets</a></div>
<div><a class="link" href="../CLI/cbepctl-intro.html" title="cbepctlツールはvBucketのステータス、設定、メモリとディスク永続化の挙動をコントロールするために利用します。">cbepctlツール</a></div>
<div><a class="link" href="../CLI/CBepctl/cbepctl-diskwritequeue.html" title="ディスク書込みキュー割り当てはソースノードから宛先ノードへと送信されるデータの度合いに影響します。">ディスク書込みキュー割り当ての変更</a></div>
<div><a class="link" href="../UI/ui-monitoring-statistics.html" title="Within the Data Bucket tab, information and statistics about buckets and nodes is displayed for the entire Couchbase Server cluster. The information is aggregated from all the server nodes within the configured cluster for the selected bucket.">Monitoring statistics</a></div></div>
</nav>



</div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b> All rights reserved.</span><a href="http://www.couchbase.com/developers">Developer Portal</a><a href="http://forums.couchbase.com">Forums</a><a href="http://www.couchbase.com/downloads">Download</a><a href="http://support.couchbase.com/">Customer Support Login</a></p></footer></div></main><script src="../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../';</script><script src="../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>